{% extends "base.html" %}

{% block title %}Profile{% endblock %}

{% block content %}
<script type="text/javascript" src="{{ url_for('static', filename='js/profile.js') }}"></script>
{% set keyboardkeys = keyboards.keys()|list %}
<script>
	function showIconDropdown(keyboardnum) {
		for (let i = 0; i < {{ keyboardkeys|length }}; i++) {
			let keyboard = document.getElementById("iconselect" + String(i));
			let keyboardbutton = document.getElementById("keyboardicon" + String(i));
			if (keyboardnum == i) {
				if (!(keyboard.classList.contains("show"))) {
				    keyboard.classList.add("show");
				}
				else {
				    keyboard.classList.remove("show");
				}

				if (!(keyboardbutton.classList.contains("active"))) {
				    keyboardbutton.classList.add("active");
				}
				else {
				    keyboardbutton.classList.remove("active");
				}
			} else {
				if (keyboard.classList.contains("show")) {
				    keyboard.classList.remove("show");
				}
				if (keyboardbutton.classList.contains("active")) {
				    keyboardbutton.classList.remove("active");
				}
			}
		}
	} 

function swapkeyboards(id1, id2) {

	// temp = id1
	var icon = document.getElementById("keyboardicon" + String(id1)).innerHTML;
	var p1 = document.getElementById("phrasesetting" + String(id1)+"0").value;
	var p2 = document.getElementById("phrasesetting" + String(id1)+"1").value;
	var p3 = document.getElementById("phrasesetting" + String(id1)+"2").value;

	// id1 = id2
	document.getElementById("keyboardicon" + String(id1)).innerHTML = document.getElementById("keyboardicon" + String(id2)).innerHTML;
	document.getElementById("phrasesetting" + String(id1)+String(0)).value = document.getElementById("phrasesetting" + String(id2)+String(0)).value;
	document.getElementById("phrasesetting" + String(id1)+String(1)).value = document.getElementById("phrasesetting" + String(id2)+String(1)).value;
	document.getElementById("phrasesetting" + String(id1)+String(2)).value = document.getElementById("phrasesetting" + String(id2)+String(2)).value;

	// id2 = temp
	document.getElementById("keyboardicon" + String(id2)).innerHTML = icon;
	document.getElementById("phrasesetting" + String(id2)+String(0)).value = p1;
	document.getElementById("phrasesetting" + String(id2)+String(1)).value = p2;
	document.getElementById("phrasesetting" + String(id2)+String(2)).value = p3;
	
}

</script>



<div class="column40">
	<h1>Accent Preferences</h1>
	<form action="" method="post" novalidate>
		{{ form.hidden_tag() }}
		{{ form.accent_form.hidden_tag() }}
		{{ form.password_form.hidden_tag() }}
		{{ form.email_form.hidden_tag() }}
		<p>
			{{ form.accent_form.accent_dropdown.label }}
			{{ form.accent_form.accent_dropdown() }}
			{% for error in form.accent_form.accent_dropdown.errors %}
			<span class="error">[{{ error }}]</span>
			{% endfor %}
		</p>
		<p>
			{{ form.accent_form.gender_dropdown.label }}
			{{ form.accent_form.gender_dropdown() }}
			{% for error in form.accent_form.gender_dropdown.errors %}
			<span class="error">[{{ error }}]</span>
			{% endfor %}
		</p>
		<p>
			{{ form.accent_form.speed.label }}
			<output for="age" id="selected-age">{{ form.accent_form.speed.data }}</output>
			{{ form.accent_form.speed(min=0, max=100, oninput="outputUpdate(value)") }}
			
			{% for error in form.accent_form.speed.errors %}
			<span class="error">[{{ error }}]</span>
			{% endfor %}
		</p>
		<p>{{ form.accent_submit() }}</p>
	<h1>Your Details</h1>
		<p>
			{{ form.password_form.password.label }}
			<br>
			{{ form.password_form.password(size=32) }}
			{% for error in form.password_form.password.errors %}
			<span class="error">[{{ error }}]</span>
			{% endfor %}
		<p>
			{{ form.password_form.new_password.label }}
			<br>
			{{ form.password_form.new_password(size=32) }}
			{% for error in form.password_form.new_password.errors %}
			<span class="error">[{{ error }}]</span>
			{% endfor %}
		</p>
		<p>
			{{ form.password_form.new_password2.label }}
			<br>
			{{ form.password_form.new_password2(size=32) }}
			{% for error in form.password_form.new_password2.errors %}
			<span class="error">[{{ error }}]</span>
			{% endfor %}
		</p>
		<p>{{ form.password_submit() }}</p>
		<p>
			{{ form.email_form.email.label }}
			<br>
			{{ form.email_form.email(size=32) }}
			{% for error in form.email_form.email.errors %}
			<span class="error">[{{ error }}]</span>
			{% endfor %}
		</p>
		<p>{{ form.email_submit() }}</p>
	</form>
</div>

<div style="width:10%; float: left;"><p> </p></div>

<div class="column50">
	<h1>Custom Phrases</h1>

	<div id="keyboardsettings">
		{% for i in range(5) %}
			
			{% if i < keyboardkeys|length %}

				<div id="keyboardsetting{{ i }}" class="keyboardsetting show">

					 <div class="icondropdown">
						<button id="keyboardicon{{ i }}" class="iconbutton" onClick="showIconDropdown({{ i }})">&#x{{ keyboardkeys[i][2:] }}</button>
						<div id="iconselect{{ i }}" class="iconoptions">
							<a href="#">Link 1</a>
							<a href="#">Link 2</a>
							<a href="#">Link 3</a>
						</div>
					</div> 

						<input type="text" id="phrasesetting{{ i }}0" class="phrasesetting" value="{{ keyboards[keyboardkeys[i]][0] }}">
						{% if i != 0 %}
						<button class="arrow show" onClick="swapkeyboards({{ i }}, {{ i-1 }})">▲</button>
						{% endif %}
						<br><input type="text" id="phrasesetting{{ i }}1" class="phrasesetting" value="{{ keyboards[keyboardkeys[i]][1] }}">
						<button class="add show">-</button>
						<br><input type="text" id="phrasesetting{{ i }}2" class="phrasesetting" value="{{ keyboards[keyboardkeys[i]][2] }}">
						{% if i != keyboardkeys|length - 1 %}
						<button class="arrow show" onClick="swapkeyboards({{ i }}, {{ i+1 }})">▼</button>
						{% else %}
						<button class="arrow" onClick="swapkeyboards({{ i }}, {{ i+1 }})">▼</button>
						{% endif %}
					<br><br>
				</div>

			{% else %}

				<div id="keyboardsetting{{ i }}" class="keyboardsetting">

					 <div class="icondropdown">
						<button id="keyboardicon{{ i }}" class="iconbutton" onClick="showIconDropdown({{ i }})">&#x003F</button>
						<div id="iconselect{{ i }}" class="iconoptions">
							<a href="#">Link 1</a>
							<a href="#">Link 2</a>
							<a href="#">Link 3</a>
						</div>
					</div> 

						<input type="text" id="phrasesetting{{ i }}0" class="phrasesetting" value="Insert new">
						{% if i != 0 %}
						<button class="arrow show" onClick="swapkeyboards({{ i }}, {{ i-1 }})">▲</button>
						{% endif %}
						<br><input type="text" id="phrasesetting{{ i }}1" class="phrasesetting" value="Phrases for">
						<button class="add show">-</button>
						<br><input type="text" id="phrasesetting{{ i }}2" class="phrasesetting" value="This keyboard">
						{% if i != keyboardkeys|length - 1 %}
						<button class="arrow show" onClick="swapkeyboards({{ i }}, {{ i+1 }})">▼</button>
						{% else %}
						<button class="arrow" onClick="swapkeyboards({{ i }}, {{ i+1 }})">▼</button>
						{% endif %}
					<br><br>
				</div>

			{% endif %}

		{% endfor %}

		<button class="add show" style="margin-left: 260px;">+</button>
	</div>

	<form action="/keyboards" method="post">
		<input name="keyboard_submit" type="submit" value="Save">
	</form>

</div>
{% endblock %}
